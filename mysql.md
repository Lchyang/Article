# mysql 面试考点
## 事务
### 事务的原理
### 事务的ACID特性
1. 原子性：一个事务中所有操作完全成功或者失败
2. 一致性：事务开始和结束后数据的完整性没有被破坏
3. 隔离性：允许多个事务对数据进行修改
4. 持久性：事务结束之后，修改永久不会丢失（比如保存到磁盘中）
### 事务的并发控制
#### 四种事务的隔离级别
1. read uncommited
2. read commited
3. repeatable read(可重复读，mysql Innodb默认级别)
4. Serializable 串行化，效率低

#### 乐观锁、悲观锁
1. 悲观锁：先加锁，后执行操作，一锁二查三更新（select for update）
2. 乐观锁：先执行，更新的时候发现数据变了的时候再回滚（check and set）

### 如何解决高并发情况下插入值重复的问题
1. 普通情况：使用数据库的唯一索引
2. 分库分表：使用队列异步写入
3. 使用redis实现分布式锁

## 常用的字段、含义、区别
CHAR VARCHAR TEXT
INT BIGINT FLOAT DOUBLE
DATETIME TIMESTAMP(1970-2038)
## 常用数据库引擎的区别
MyISAM 不支持事务、不支持外键、只支持表锁、不支持行锁
Innodb 不支持全文索引
## 索引
索引就是数据库查找数据时的数据结构
索引的进化

1. 线性查找（慢）
2. 二分查找（插入数据慢）
3. Hash查找（占用空间大）
4. 二叉查找树（占用空间大，复杂度退化）
5. 平衡树（解决复杂度退化，占用空间大）
6. 多路查找树（节点太多，子节点只有两个）
7. 多路平衡查找树（B-Tree, 无法进行范围查找)
8. B+树中只有叶子节点会带有指向记录的指针（ROWID），而B树则所有节点都带有，在内部节点出现的索引项不会再出现在叶子节点中。
9. B+树中所有叶子节点都是通过指针连接在一起，而B树不会。

### 建表的时候根据哪些条件来创建索引
1. 经常用作查询条件的字段
2. 经常用作表联接的字段
3. 经常在order by group by之后出现在字段

### 创建索引的时候注意事项
1. 表的主键. 外键必须有索引；
2. 数据量超过300的表应该有索引；
3. 经常与其他表进行连接的表，在连接字段上应该建立索引；
4. 经常出现在Where子句中的字段，特别是大表的字段，应该建立索引；
5. 索引应该建在选择性高的字段上；
6. 索引应该建在小字段上，对于大的文本字段甚至超长字段，不要建索引；
7. 复合索引的建立需要进行仔细分析；尽量考虑用单字段索引代替：

>  正确选择复合索引中的主列字段，一般是选择性较好的字段；
复合索引的几个字段是否经常同时以AND方式出现在Where子句中？单字段查询是否极少甚至没有？如果是，则可以建立复合索引；否则考虑单字段索引；

> 如果复合索引中包含的字段经常单独出现在Where子句中，则分解为多个单字段索引；

> 如果复合索引所包含的字段超过3个，那么仔细考虑其必要性，考虑减少复合的字段；

> 如果既有单字段索引，又有这几个字段上的复合索引，一般可以删除复合索引；搜索

8. 频繁进行数据操作的表，不要建立太多的索引；
9. 删除无用的索引，避免对执行计划造成负面影响；
